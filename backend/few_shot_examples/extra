,
  {
    "question": "How is operating cash flow trending across quarters in 2023, and does it support net income in each quarter?",
    "sql": "SELECT fp.fiscal_quarter, SUM(CASE WHEN li.normalized_code='NI' THEN ff.value END) AS operating_cash_flow FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE s.statement_type='cashflow' AND fp.fiscal_year=2023 GROUP BY fp.fiscal_quarter ORDER BY fp.fiscal_quarter;"
  },
  {
    "question": "Compare total liabilities and total assets between 2022 and 2023, show actuals, difference, and ratio.",
    "sql": "SELECT t2022.assets AS assets_2022, t2023.assets AS assets_2023, t2022.liabilities AS liabilities_2022, t2023.liabilities AS liabilities_2023, (t2023.assets - t2022.assets) AS assets_diff, (t2023.liabilities - t2022.liabilities) AS liabilities_diff, ((t2023.assets - t2022.assets)*1.0/NULLIF(t2022.assets,0)) AS assets_ratio, ((t2023.liabilities - t2022.liabilities)*1.0/NULLIF(t2022.liabilities,0)) AS liabilities_ratio FROM (SELECT SUM(CASE WHEN li.normalized_code IN ('CASH','AR') THEN ff.value END) AS assets, SUM(CASE WHEN li.normalized_code='AP' THEN ff.value END) AS liabilities FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE fp.fiscal_year=2022 AND s.statement_type='balance') t2022, (SELECT SUM(CASE WHEN li.normalized_code IN ('CASH','AR') THEN ff.value END) AS assets, SUM(CASE WHEN li.normalized_code='AP' THEN ff.value END) AS liabilities FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE fp.fiscal_year=2023 AND s.statement_type='balance') t2023;"
  },
  {
    "question": "Which line items contributed most to the change in net income between 2022 and 2023?",
    "sql": "SELECT li.name, t2022.value AS value_2022, t2023.value AS value_2023, (t2023.value - t2022.value) AS difference FROM (SELECT li.line_item_id, SUM(ff.value) AS value FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE fp.fiscal_year=2022 AND s.statement_type='income' GROUP BY li.line_item_id) t2022 JOIN (SELECT li.line_item_id, SUM(ff.value) AS value FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE fp.fiscal_year=2023 AND s.statement_type='income' GROUP BY li.line_item_id) t2023 ON t2022.line_item_id = t2023.line_item_id JOIN line_item li ON li.line_item_id = t2022.line_item_id ORDER BY difference DESC;"
  },
  {
    "question": "How did operating expenses compare to revenue in each quarter of 2023, and which quarter had the lowest operating efficiency?",
    "sql": "SELECT fp.fiscal_quarter, SUM(CASE WHEN li.normalized_code='REV' THEN ff.value END) AS revenue, SUM(CASE WHEN li.normalized_code='OPEX' THEN ff.value END) AS operating_expenses, (SUM(CASE WHEN li.normalized_code='REV' THEN ff.value END) - SUM(CASE WHEN li.normalized_code='OPEX' THEN ff.value END)) AS operating_profit FROM financial_fact ff JOIN line_item li ON ff.line_item_id = li.line_item_id JOIN statement s ON ff.statement_id = s.statement_id JOIN fiscal_period fp ON s.period_id = fp.period_id WHERE s.statement_type='income' AND fp.fiscal_year=2023 GROUP BY fp.fiscal_quarter ORDER BY operating_profit ASC;"
  }